on_sex_life_management = {
			effect = {
				save_temporary_scope_as = root_sex_life_character
				if = { 
					limit = { 
						has_variable = libido
						has_variable = sexual_desire
						has_variable = penis_size_preference
						has_variable = breast_size_preference
						has_variable = muscles
						trigger_if = {
							limit = { has_variable = sexual_desire }
							var:sexual_desire >= 10
						}
					}
					if = {
						limit = { var:libido >= 10 }
						every_relation = {
							type = lover
							limit = {
								has_variable = libido
								trigger_if = {
									limit = { has_variable = libido }
									var:libido >= 10
								}
								Not = {
									is_target_in_variable_list = {
										name = had_sex_this_month
										target = scope:root_sex_life_character
									}
								}
							}
							add_to_temporary_list = sexual_partner_list
							save_temporary_scope_as = potential_sexual_partner
						}
						every_relation = {
							type = soulmate
							limit = {
								has_variable = libido
								trigger_if = {
									limit = { has_variable = libido }
									var:libido >= 10
								}
								Not = {
									is_target_in_variable_list = {
										name = had_sex_this_month
										target = scope:root_sex_life_character
									}
								}
							}
							add_to_temporary_list = sexual_partner_list
							save_temporary_scope_as = potential_sexual_partner
						}
						every_consort = {
							limit = { 
								has_variable = libido
								trigger_if = {
									limit = { has_variable = libido }
									var:libido >= 10
								}
								Not = {
									is_target_in_variable_list = {
										name = had_sex_this_month
										target = scope:root_sex_life_character
									}
								}
							}
							add_to_temporary_list = sexual_partner_list
							save_temporary_scope_as = potential_sexual_partner
						}
						if = {
							limit = {
								any_in_list = {
									list = sexual_partner_list
									count >= 1
								}
							}
							set_variable = { 
								name = sex_life_chain
								value = yes
							}
							random_in_list = {
								list = sexual_partner_list
								weight = {
									base = 100
									physical_attraction_modifier = {
										ATTRACTED = scope:root_sex_life_character
										WHO = scope:potential_sexual_partner
										MAX_ATTRACTION = 100
									}
								}
								save_temporary_scope_as = chosen_sexual_partner
							}
							match_sexual_partners_to_event_effect = { CHARACTER = scope:chosen_sexual_partner }
						}
					}
				}
			}
		}

on_set_relation_lover = {
			on_actions = {
				on_ai_marriage
			}
		}

on_ai_marriage = {
		trigger = { 
			is_ai = yes
			is_landed = no
			trigger_if = {
				limit = { exists = liege }
				Not = { is_any_family_relation_or_spouse_trigger = { CHARACTER = root.liege } }
				Not = { is_great_grandparent_of = root.liege }
				Not = { is_great_grandchild_of = root.liege }
			}
			scope:target = { 
				is_ai = yes
				is_landed = no
				trigger_if = {
					limit = { exists = liege }
					Not = { is_any_family_relation_or_spouse_trigger = { CHARACTER = scope:target.liege } }
					Not = { is_great_grandparent_of = scope:target.liege }
					Not = { is_great_grandchild_of = scope:target.liege }
				}
			}
			can_marry_character_trigger = { CHARACTER = scope:target }
		}
		effect = {
			marry = scope:target
		}
	}