namespace = carnm_prostitution_random_events

#
# 0001. Woman of the People
# 0002-3. Learned a secret
#

#
# 0001. Woman of the People
#

carnm_prostitution_random_events.0001 = {
	type = character_event
	title = carnm_prostitution_random_events.0001.t
	desc = carnm_prostitution_random_events.0001.desc

	theme = seduce_scheme

	override_background = {
		event_background = alley_night
	}

	left_portrait = {
		character = root
		animation = flirtation
	}

	weight_multiplier = {
		base = 1
		carn_prostitution_good_event_modifier = yes
	}

	trigger = {
		NOT = { has_character_modifier = carnm_made_peasants_happy_modifier }
	}

	option = { # Make the peasants VERY happy
		name = carnm_prostitution_random_events.0001.a
		add_character_modifier = {
			modifier = carnm_made_peasants_happy_modifier
			years = 5
		}
		stress_impact = {
			humble = minor_stress_impact_loss
			gregarious = medium_stress_impact_loss
			arrogant = minor_stress_impact_gain
			shy = medium_stress_impact_gain
		}
	}

	option = { # don't associate with the riffraff
		name = carnm_prostitution_random_events.0001.b
		add_prestige = minor_prestige_gain
		stress_impact = {
			humble = medium_stress_impact_gain
			gregarious = minor_stress_impact_gain
			shy = minor_stress_impact_loss
		}
	}
}

#
# 0002. Learned a secret - setup event
#

carnm_prostitution_random_events.0002 = {
	type = empty
	hidden = yes

	weight_multiplier = {
		base = 1
		carn_prostitution_good_event_modifier = yes
	}
	
	trigger = {
		OR = {
			any_courtier_or_guest = {
				any_known_secret = {
					NOT = { is_known_by = root }
				}
			}
			any_vassal_or_below = {
				any_known_secret = {
					NOT = { is_known_by = root }
				}
			}
		}
	}

	immediate = {
		every_courtier_or_guest = {
			every_known_secret = {
				add_to_temporary_list = potential_discovered_secret
			}
		}
		every_vassal_or_below = {
			every_known_secret = {
				add_to_temporary_list = potential_discovered_secret
			}
		}
		random_in_list = {
			list = potential_discovered_secret
			limit = {
				NOT = { is_known_by = root }
			}
			save_scope_as = discovered_secret
		}
		if = {
			limit = {
				exists = scope:discovered_secret
			}
			scope:discovered_secret = {
				secret_owner = {
					save_scope_as = discovered_secret_owner
				}
			}
			if = {
				limit = {
					exists = scope:discovered_secret_owner
				}
				trigger_event = { id = carnm_prostitution_random_events.0003 }
			}
		}
	}
}

#
# 0002. Learned a secret!
#

carnm_prostitution_random_events.0003 = {
	type = character_event
	title = carnm_prostitution_random_events.0003.t
	desc = carnm_prostitution_random_events.0003.desc

	theme = seduce_scheme

	override_background = {
		event_background = bedchamber
	}

	left_portrait = {
		character = root
		animation = flirtation
	}

	right_portrait = {
		character = scope:discovered_secret_owner
		animation = worry
	}

	immediate = {
		play_music_cue = "mx_cue_secret"
	}

	option = { # interesting...
		name = carnm_prostitution_random_events.0003.a
		scope:discovered_secret = {
			reveal_to = root
		}
	}
}