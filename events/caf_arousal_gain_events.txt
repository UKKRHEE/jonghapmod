namespace = caf_arousal_events

# Update arousal related modifiers
caf_arousal_events.0001 = {
	hidden = yes

	trigger = {	
		OR = {
			has_game_rule = cc_arousal_effects_enabled
			has_game_rule = cc_arousal_effects_hardcore
		}
	}

	immediate = {
		caf_update_arousal_modifier = yes
	}
}

# Increase arousal periodically (sophisticated calculation)
caf_arousal_events.0002 = {
	hidden = yes

	trigger = {
		is_ai = no
	}

	# Player character changed without dying
	on_trigger_fail = {
		# Flag needs to be removed in case we lose control of a character (thus dropping out of this event loop), but get to play this character again later
		remove_character_flag = caf_track_arousal_periodically
	}

	immediate = {
		# Calculation prepwork
		every_consort = {
			limit = { 
				carn_can_have_sex_trigger = yes
				root = { is_attracted_to_gender_of = prev }
			}
			add_to_temporary_list = all_sexual_partners
			add_to_temporary_list = official_sexual_partners
		}
		every_relation = {
			type = lover
			limit = { 
				carn_can_have_sex_trigger = yes
				NOT = { is_in_list = official_sexual_partners } # Lovers might also be spouses
			}
			add_to_temporary_list = all_sexual_partners
			add_to_temporary_list = secret_sexual_partners
		}
		
		caf_add_arousal = { VALUE = caf_arousal_gain_sophisticated_all }

		trigger_event = {
			id = caf_arousal_events.0002
			days = 6
		}
	}
}


# Increase arousal periodically (simple calculation)
caf_arousal_events.0003 = {
	hidden = yes

	trigger = {
		is_ai = no
	}

	# Player character changed without dying
	on_trigger_fail = {
		# Flag needs to be removed in case we lose control of a character (thus dropping out of this event loop), but get to play this character again later
		remove_character_flag = caf_track_arousal_periodically
	}

	immediate = {
		caf_add_arousal = { VALUE = 1 }
		trigger_event = {
			id = caf_arousal_events.0003
			days = 7
		}
	}
}