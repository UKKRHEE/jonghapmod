namespace = ie_pet_animal

# "A Girl's Best Friend"
ie_pet_animal.0001 = {
	type = character_event
	title = ie_pet_animal.0001.t
	desc = ie_pet_animal.0001.desc
	theme = pet
	override_background = { event_background = bedchamber }

	trigger = {
		exists = scope:story
		NOT = { has_character_flag = refused_ie_pet_animal_0001 }
		NOT = { has_character_flag = had_event_ie_pet_animal_0001 }
		has_game_rule = carn_content_bestiality_enabled
		is_available_healthy_adult = yes
		is_female = yes
		scope:story = { var:dog_gender = flag:male }
		OR = {
			has_trait = lustful
			has_trait = fecund
			has_trait = deviant
		}
		any_spouse = {
			is_available_healthy_ai_adult = yes
			count = 0
		}
	}

	weight_multiplier = {
		base = 1
		modifier = {
			add = 2
			carn_has_fetish_trigger = { FETISH = bestiality }
		}
	}

	immediate = {
		add_character_flag = {
			flag = had_event_ie_pet_animal_0001
			years = 5
		}
	}

	option = {
		name = ie_pet_animal.0001.a
		custom_tooltip = ie_pet_animal.0001.a.tt

		trigger_event = {
			id = ie_pet_animal.0002
			days = { 1 3 }
		}
	}

	option = {
		name = ie_pet_animal.0001.b
		custom_tooltip = ie_pet_animal.0001.b.tt
		
		add_character_flag = { 
			flag = refused_ie_pet_animal_0001 
		}
		add_stress = minor_stress_impact_loss
	}
}

# "A Girl's Best Friend" (cont.)
ie_pet_animal.0002 = {
	type = character_event
	title = ie_pet_animal.0001.t
	desc = ie_pet_animal.0002.desc
	theme = pet
	override_background = { event_background = bedchamber }

	immediate = {
		# A fake character called "Dog" (I couldn't insert the dogs real name)
		create_character = {
			name = Dog
			location = root.capital_province
			template = beautiful_peasant_character
			dynasty = none
			gender = male
			save_scope_as = dog
		}
		hidden_effect = {
			scope:dog = { add_trait = ie_masked } # For Carnalitas Arousal Framework, to suppress name/portrait of our fake character
		}
	}

	option = {
		name = ie_pet_animal.0002.a
		custom_tooltip = ie_pet_animal.0002.a.tt

		carn_add_fetish_effect = { FETISH = bestiality }

		hidden_effect = {
			send_interface_toast = {
				type = event_toast_effect_good
				title = ie_pet_animal.0001.t
				custom_tooltip = ie_pet_animal.0002.a.toast.desc
			}

			# Should request a Carnalitas bestiality scene here instead, once possible.

			carn_had_sex_with_effect = {
				CHARACTER_1 = scope:story.story_owner
				CHARACTER_2 = scope:dog
				C1_PREGNANCY_CHANCE = 0
				C2_PREGNANCY_CHANCE = 0
				STRESS_EFFECTS = yes
				DRAMA = no
			}
		}
	}

	option = {
		name = ie_pet_animal.0002.b
		custom_tooltip = ie_pet_animal.0002.b.tt

		add_stress = minor_stress_impact_gain
	}
}
